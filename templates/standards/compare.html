{% extends 'base.html' %}
{% block title %}Comparison{% endblock %}
{% block content %}
<h1 class="text-3xl font-semibold mb-2 tracking-tight">Comparison Engine</h1>
<form action="" method="get" class="mb-4 flex gap-2">
  <input name="topic" value="{{ topic }}" placeholder="Topic e.g. Risk, Stakeholder" class="border rounded-lg px-3 py-2 w-full" />
  <button class="px-4 py-2 bg-blue-600 text-white rounded-lg">Compare</button>
  {% if topic %}<a href="?" class="px-4 py-2 border rounded-lg bg-white">Clear</a>{% endif %}
  </form>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
  {% for entry in hits_list %}
  <div class="bg-white border rounded p-3">
    <div class="font-medium">{{ entry.standard.title }}</div>
    <ul class="mt-2 space-y-2 text-sm">
      {% for h in entry.items %}
      <li>
        <a class="text-blue-600" href="{% url 'standards:page' entry.standard.slug h.page_index %}">Page {{ h.page_index }}</a>
        <div class="text-gray-600">{{ h.snippet }}</div>
      </li>
      {% empty %}
      <li class="text-gray-400">No hits.</li>
      {% endfor %}
    </ul>
  </div>
  {% endfor %}
</div>

{% if similarity %}
<h2 class="text-xl font-semibold mt-8 mb-2">Similarities</h2>
<ul class="space-y-2 text-sm">
  {% for s in similarity %}
  <li class="bg-white border rounded p-3">
    <div class="text-gray-700">{{ s.a.title }} ↔ {{ s.b.title }} ({{ s.score }}%)</div>
    <div class="mt-1">
      <a class="text-blue-600" href="{% url 'standards:page' s.a.slug s.a_idx %}">Open {{ s.a.title }} page {{ s.a_idx }}</a>
      ·
      <a class="text-blue-600" href="{% url 'standards:page' s.b.slug s.b_idx %}">Open {{ s.b.title }} page {{ s.b_idx }}</a>
    </div>
  </li>
  {% endfor %}
</ul>
{% endif %}

<h2 class="text-xl font-semibold mt-8 mb-2">Unique Points</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
  {% for entry in unique_list %}
  <div class="bg-white border rounded p-3">
    <div class="font-medium">{{ entry.standard.title }}</div>
    <ul class="mt-2 space-y-2 text-sm">
      {% for h in entry.items %}
      <li>
        <a class="text-blue-600" href="{% url 'standards:page' entry.standard.slug h.page_index %}">Page {{ h.page_index }}</a>
        <div class="text-gray-600">{{ h.snippet }}</div>
      </li>
      {% empty %}
      <li class="text-gray-400">None detected.</li>
      {% endfor %}
    </ul>
  </div>
  {% endfor %}
</div>
{% endblock %}


